<!DOCTYPE html>
<html lang="ua">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ElectroCats</title>
    <link rel="stylesheet" href="Style/style.css">
</head>
<body>
    <div class="h2">
        <div class="h1">
            <div >
                <br><br><br><br><br><br><br><br><br><br><br><br>
                <span class="name" >ElectroCats</span>
            </div>
            <div >
                <button id="continue" class="buton_1" onclick="openModalDelayed()">Розпочати гру</button><br>
                <button class="buton_1">Налаштування</button>
            </div><br>
            <button onclick="toggleTheme()" class="tema">Змінити тему</button>
        </div>
    </div>
    <div class="window_akva">
        <!-- Остальне -->
        <div class="menu_akva">
            <button id="openBtn" class="buton_2-1"></button>
            <button class="buton_2-2"></button>
            <button class="buton_2-3"></button>
            <button class="buton_2-4"></button>
        </div>
        <div class="akva">

            <div id="container">

                <!-- Вспливашки -->
                <div id="myModal" class="modal">
                    <div class="modal-content">
                        
                        <H1 style="text-align: center;">НАВЧАННЯ</H1>
                        <div style="display: flex; align-items: center; flex-wrap: wrap;">
                            <div style="flex: 0 0 auto;">
                                <img src="image/eat.png" alt="eat" style="width: 150px; height: 150px;">
                                <img src="image/mitya.png" alt="mitya" style="width: 150px; height: 150px;">
                            </div>
                            <div style="flex: 5;">
                                <span style="text-align: right;">Ви можете скористатися кнопкою «їжа»,
                                    аби порадувати мешканців акваріума смачним кормом. Також ви можете вимити акваріум
                                    з-за допомогою «губка», коли той забрудниться.</span>
                            </div>
                            <div style="flex: 0 auto;">
                                <span style="text-align: right;">Ви завжди можете завітати в «магазин», аби придбати 
                                    нових рибок, скористатися кнопкою «налаштування» для покращення
                                ігрового процесу та «вийти з гри» для завершення.</span>
                            </div>
                            <div style="flex: 5;">
                                <img src="image/setting.png" alt="setting" style="width: 150px; height: 150px;">
                                <img src="image/exit.png" alt="exit" style="width: 150px; height: 150px;">
                                <img src="image/shop.png" alt="shop" style="width: 150px; height: 150px;">
                            </div>
                            <div style="flex: 0 auto;">
                                <span style="text-align: right;">Кредити вказують
                                     на поточну кількість ваших грошей. Ви можете 
                                     скористатися ними, щоб придбати нових рибок.</span>
                            </div>
                            <div style="flex: 5;">
                                <img src="image/kesh.png" alt="kesh" style="width: 150px; height: 150px;">
                            </div>
                        </div>
                        <button class="close-2" onclick="closeModal()">ОК</button>    
                    </div>
                </div>

                <!-- Решта -->
                <button class="button-left-3" onclick="openModal()"></button>
                <button class="button-right-3" id="toggleMenu"></button>
            </div>

        </div>
        <!-- Магазин -->
        <div id="popup" class="popup">
            <div class="popup-content">
                <div><br>
                    <span style="margin-left: 48px; font-size: 36px;" ><img src="image/kesh.png" alt="kesh" style="height: 50px; width: 50px;">Кредити:</span> <button class="close" id="closeBtn">&times;</button>
                </div>
                <div class="shop-adres"><br>
                    ______________________________________________________________________________________________________________________________
                    <img src="image/fish-1.png" alt="fish-1" class="image-shop"><button class="shop-buton-1">6</button><button class="shop-buton-2" onclick="createMovingImage('image/fish-1.png')">Купити Рибку</button><br>
                    ______________________________________________________________________________________________________________________________
                    <img src="image/fish-2.png" alt="fish-2" class="image-shop"><button class="shop-buton-1">8</button><button class="shop-buton-2" onclick="createMovingImage('image/fish-2.png')">Купити Рибку</button><br>
                    ______________________________________________________________________________________________________________________________
                    <img src="image/fish-3.png" alt="fish-3" class="image-shop"><button class="shop-buton-1">2</button><button class="shop-buton-2" onclick="createMovingImage('image/fish-3.png')">Купити Рибку</button><br>
                    ______________________________________________________________________________________________________________________________
                    <img src="image/fish-4.png" alt="fish-4" class="image-shop"><button class="shop-buton-1">10</button><button class="shop-buton-2" onclick="createMovingImage('image/fish-4.png')">Купити Рибку</button><br>
                    ______________________________________________________________________________________________________________________________
                    <img src="image/fish-5.png" alt="fish-5" class="image-shop"><button class="shop-buton-1">12</button><button class="shop-buton-2" onclick="createMovingImage('image/fish-5.png')">Купити Рибку</button><br>
                    ______________________________________________________________________________________________________________________________
                    <img src="image/fish-6.png" alt="fish-6" class="image-shop"><button class="shop-buton-1">14</button><button class="shop-buton-2" onclick="createMovingImage('image/fish-6.png')">Купити Рибку</button><br>
                    ______________________________________________________________________________________________________________________________
                    <img src="image/fish-7.png" alt="fish-7" class="image-shop"><button class="shop-buton-1">16</button><button class="shop-buton-2" onclick="createMovingImage('image/fish-7.png')">Купити Рибку</button><br>
                    ______________________________________________________________________________________________________________________________
                    <img src="image/fish-8.png" alt="fish-8" class="image-shop"><button class="shop-buton-1">18</button><button class="shop-buton-2" onclick="createMovingImage('image/fish-8.png')">Купити Рибку</button><br>
                    ______________________________________________________________________________________________________________________________
                    <img src="image/kriv-1.png" alt="kriv-1" class="image-shop"><button class="shop-buton-1">15</button><button class="shop-buton-2" onclick="createMovingImage('image/kriv-1.png')">Купити Криветку</button><br>
                    ______________________________________________________________________________________________________________________________
                    <img src="image/kriv-2.png" alt="kriv-2" class="image-shop"><button class="shop-buton-1">20</button><button class="shop-buton-2" onclick="createMovingImage('image/kriv-2.png')">Купити Криветку</button><br>
                    ______________________________________________________________________________________________________________________________
                    <img src="image/ravlik.png" alt="ravlik" class="image-shop"><button class="shop-buton-1">50</button><button class="shop-buton-2" style="margin-bottom: 100px;" onclick="createMovingImage('image/ravlik.png')">Купити Равлика</button>
                    ______________________________________________________________________________________________________________________________
                </div>
            </div>
        </div>

    </div>

    <script>
        // Тема
        function toggleTheme() {
                var body = document.body;
                body.classList.toggle('light-theme');
                body.classList.toggle('dark-theme');
            }

        // Вспливашки ___________________________________
        function openModalDelayed() {
                setTimeout(function () {
                    document.getElementById("myModal").style.display = "block";
                }, 3000); 
            }
        function openModal() {
                setTimeout(function () {
                    document.getElementById("myModal").style.display = "block";
                }, 1);
            }

        function closeModal() {
            document.getElementById("myModal").style.display = "none";
        }


        // Меню ___________________________

        var continueBtn = document.getElementById("continue");
            var menuContent = document.querySelector(".window_akva");
            var electrocatsContent = document.querySelector(".h2");
            var toggleBtn = document.getElementById("toggleMenu");

            continueBtn.addEventListener("click", function () {
                menuContent.classList.toggle("show");
                electrocatsContent.classList.toggle("hide");
            });

            toggleBtn.addEventListener("click", function () {
                menuContent.classList.toggle("show");
                electrocatsContent.classList.toggle("hide");
            });
        

        // Магазин ______________________

        var openBtn = document.getElementById("openBtn");
        var closeBtn = document.getElementById("closeBtn");
        var popup = document.getElementById("popup");

        
        openBtn.addEventListener("click", function () {
            popup.style.display = "block";
        });
        
        closeBtn.addEventListener("click", function () {
            popup.style.display = "none";
        });

        window.addEventListener("click", function (event) {
            if (event.target == popup) {
                popup.style.display = "none";
            }
        });


        // Рух рибки та відзеркалення
        function getRandomNumber(min, max) {
                return Math.floor(Math.random() * (max - min + 1) + min);
            }

       function createMovingImage(imageUrl) {
            
            var img = document.createElement('img');
            img.src = imageUrl; 

            var x = getRandomNumber(0, 1700); 
            var y = getRandomNumber(0, 700); 

            img.style.left = x + 'px';
            img.style.top = y + 'px';

            img.classList.add('moving-image');

            document.getElementById('container').appendChild(img);

            setInterval(function () {
                var newX = getRandomNumber(0, 1700);
                var newY = getRandomNumber(0, 500);

                var direction = newX > parseInt(img.style.left) ? 'right' : 'left';

                img.style.transition = 'transform 0.1s linear';
                img.style.transform = direction === 'left' ? 'scaleX(-1)' : 'scaleX(1)';

                img.style.transition = 'left 4s, top 4s';
                img.style.left = newX + 'px';
                img.style.top = newY + 'px';

                if (parseInt(img.style.left) < 0) {
                    img.style.left = '0px';
                } else if (parseInt(img.style.left) > 1700) {
                    img.style.left = '1700px';
                }

                if (parseInt(img.style.top) < 0) {
                    img.style.top = '0px';
                } else if (parseInt(img.style.top) > 700) {
                    img.style.top = '700px';
                }
            }, 2000); 
        }

        // Бекенд
        // ID___________________________________________
        async function createSession() {
            const response = await fetch('/play/', {
                method: 'POST'
            });
            const data = await response.json();

            // Зберігаємо id сесії у sessionStorage
            sessionStorage.setItem('sessionId', data.id);
        }
        window.onload = createSession;

        // Голод
        async function checkHunger() {
             const session_id = sessionStorage.getItem('sessionId'); // Отримуємо session_id із sessionStorage
            if (session_id) {
                const response = await fetch(`/get-hungry/${session_id}`);
                const data = await response.json();
                document.getElementById('hunger-status').innerText = 'Hungry: ' + data.hungry;

                // Перевіряємо, чи голод досяг 100
                if (data.hungry >= 100) {
                    // Отримуємо посилання на елемент <img> за його id
                    const imgElement = document.getElementById('your-image-id');

                    // Видаляємо <img> з DOM
                    imgElement.remove();
                }
            } else {
                console.log('Session ID not found in sessionStorage.');
            }
        }

        // Викликаємо функцію checkHunger() кожні 10 секунд
        setInterval(checkHunger, 10000);
</script>
    
</body>
</html>